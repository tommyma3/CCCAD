include: config/model/ad_base.yaml

model: CompressedAD

# Compression Transformer (must match cad_dktd.yaml)
tf_n_embd: 32           # Match cad_dktd.yaml and AD baseline
tf_n_layer: 4           # Match cad_dktd.yaml  
tf_n_head: 4            # Match cad_dktd.yaml
tf_dropout: 0.1
tf_attn_dropout: 0.1
tf_n_inner: 128         # Match cad_dktd.yaml
n_transit: 100           # Match cad_dktd.yaml - larger for complex task

# Compression Settings (must match cad_dktd.yaml)
n_compress_tokens: 48   # Match cad_dktd.yaml
compress_n_layers: 4    # Match cad_dktd.yaml
compress_n_heads: 4     # Match cad_dktd.yaml

# Pre-training specific - longer training for better compression
pretrain_timesteps: 40000   # More pretraining for better compression
pretrain_batch_size: 512
pretrain_lr: 0.0003
pretrain_warmup_steps: 2000

# Dataset
train_source_timesteps: 2000  # Match fine-tuning config
train_n_stream: 100

num_workers: 16
